{% block head %}
    {% include 'home/head.html.twig' %}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        // Load both corechart and geochart packages
        google.charts.load('current', {'packages':['corechart', 'geochart']});

        // Set the callback to draw both charts
        google.charts.setOnLoadCallback(function() {
            drawChart();
            drawRegionsMap();
            drawBandwidthChart();
            pingLatencyChart();
            ispChart();
            serverNameChart();
        });

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['timestamp', 'download_bytes', 'upload_bytes'],
                {% for rows in chartData %}
                ['{{ rows.timestamp }}', {{ rows.download_bytes }}, {{ rows.upload_bytes }}],
                {% endfor %}
            ]);

            var options = {
                curveType: 'function',
                legend: { position: 'right' },
                lineWidth: 3,
                pointSize: 5,
                hAxis: {
                    gridlines: {
                        color: '#e5e5e5'
                    }
                }
            };

            var chart = new google.visualization.LineChart(document.getElementById('downloads_chart'));
            chart.draw(data, options);
        }

        function drawBandwidthChart() {
            var data = google.visualization.arrayToDataTable([
                ['timestamp', 'download_bandwidth', 'upload_bandwidth'],
                {% for rows in chartData %}
                ['{{ rows.timestamp }}', {{ rows.download_bandwidth }}, {{ rows.upload_bandwidth }}],
                {% endfor %}
            ]);

            var options = {
                title: 'Download & Upload Bandwidth over Time',
                curveType: 'function',
                legend: { position: 'right' },
                hAxis: { title: 'Timestamp' },
                vAxis: { title: 'Bandwidth (Mb/s)' }
            };

            var chart = new google.visualization.LineChart(document.getElementById('bandwidth_chart'));
            chart.draw(data, options);
        }

        function pingLatencyChart() {
            var data = google.visualization.arrayToDataTable([
                ['timestamp', 'ping_latency', 'ping_low', 'ping_high'],
                {% for rows in chartData %}
                ['{{ rows.timestamp }}', {{ rows.ping_latency }}, {{ rows.ping_low }}, {{ rows.ping_high }}],
                {% endfor %}
            ]);

            var options = {
                isStacked: true,
                height: 600,
                title: 'Ping Latency over Time',
                curveType: 'function',
                legend: { position: 'right' },
            };

            var chart = new google.visualization.LineChart(document.getElementById('ping_latency_chart'));
            chart.draw(data, options);
        }

        function drawRegionsMap() {
            var data = google.visualization.arrayToDataTable([
                ['Country', 'Popularity'],
                {% for rows in countryData %}
                ['{{ rows.server_country }}', {{ rows.number_of_countries }}],
                {% endfor %}
            ]);

            var options = {};
            var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));
            chart.draw(data, options);
        }

        function ispChart() {
            var data = google.visualization.arrayToDataTable([
                ['Internet Service Provider', 'Popularity'],
                {% for rows in ispData %}
                ['{{ rows.isp }}', {{ rows.number_of_isps }}],
                {% endfor %}
            ]);

            var options = {
                title: 'Internet Service Provider Popularity',
                pieHole: 0.4,
                is3D: true
            };

            var chart = new google.visualization.PieChart(document.getElementById('isp_chart'));
            chart.draw(data, options);
        }

        function serverNameChart() {
            var data = google.visualization.arrayToDataTable([
                ['ServerName', 'Popularity'],
                {% for rows in serverNameData %}
                ['{{ rows.server_name }}', {{ rows.number_of_server_names }}],
                {% endfor %}
            ]);

            var options = {
                title: 'ServerName Popularity',
                pieHole: 0.6,
                is3D: true,
                legend: { position: 'left' },
            };

            var chart = new google.visualization.PieChart(document.getElementById('server_name_chart'));
            chart.draw(data, options);
        }
    </script>
{% endblock %}

{% block body %}
    <main>
        <h2 class="bg-red-600 text-center">Charts are currently under development</h2>
        <div class="container mx-auto max-w-8xl mb-20 md:p-10">
            <section class="flex flex-col bg-white p-2 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                <h2 class="text-center font-mono text-3xl pt-10 position:static z-10 underline decoration-4 hover:uppercase">Download & Upload Mb / run</h2>
                <div id="downloads_chart" class="h-[600px] -translate-y-14"></div>
            </section>
            <section class="flex flex-col bg-white mt-20 p-2 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                <div id="bandwidth_chart" style="width: 100%; height: 600px;"></div>
            </section>
            <section class="flex flex-col bg-white p-2 mt-10 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                <div id="ping_latency_chart" style="width:100%; height: 650px;"></div>
            </section>
            <section class="flex flex-col bg-white p-2 mt-10 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                 <div id="isp_chart" style="width: 100%; height: 650px;"></div>
            </section>
            <section class="flex flex-col bg-white p-2 mt-10 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                <div id="server_name_chart" style="width: 100%; height: 650px;"></div>
            </section>
            <section class="flex flex-col bg-white p-2 mt-10 m-2 space-y-10 shadow-2xl rounded-3xl md:p-15">
                <div id="regions_div" style="width: 100%; height: 600px;"></div>
            </section>
        </div>
    </main>
{% endblock %}
